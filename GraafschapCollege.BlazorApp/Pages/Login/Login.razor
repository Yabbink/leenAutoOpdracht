@page "/login"
@inject HttpClient Http
@inject NavigationManager Navigation
@using System.Net.Http.Headers
@using System.Text.Json
@using System.Text
@code {
    private string username;
    private string password;
    private string errorMessage;

    private async Task HandleLogin()
    {
        var loginModel = new { Username = username, Password = password };
        var json = JsonSerializer.Serialize(loginModel);
        var content = new StringContent(json, Encoding.UTF8, "application/json");

        var response = await Http.PostAsync("account/login", content);

        if (response.IsSuccessStatusCode)
        {
            var result = await response.Content.ReadAsStringAsync();
            var token = JsonSerializer.Deserialize<JsonElement>(result).GetProperty("Token").GetString();

            Http.DefaultRequestHeaders.Authorization = new AuthenticationHeaderValue("Bearer", token);
            Navigation.NavigateTo("/");
        }
        else
        {
            errorMessage = "Login failed. Please check your username and password.";
        }
    }
}

﻿<div class="d-flex align-items-center login-alignment">
    <div class="form-login w-100 h-100">
        <EditForm Model="Request" OnSubmit="LoginAsync">
            <PageHeader Size="PageHeader.Sizes.H2">Please Login!</PageHeader>

            <div class="form-floating">
                <InputText id="email" class="form-control" @bind-Value="Request.Email" placeholder="Email" />
                <label for="email">Email address</label>
            </div>

            <div class="form-floating">
                <InputText id="password" class="form-control" @bind-Value="Request.Password" placeholder="Password" type="password" />
                <label for="password">Password</label>
            </div>

            <br />

            <button class="btn btn-primary w-100 py-2" type="submit">Login</button>
        </EditForm>
    </div>
</div>